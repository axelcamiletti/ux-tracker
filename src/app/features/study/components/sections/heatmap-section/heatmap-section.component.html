<div class="heatmap-section flex">
  <div class="heatmap-content w-2/3 p-4 relative">
    <!-- Selector de prototipo -->
    <div class="prototype-selector mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Seleccionar prototipo:</label>
      <select class="bg-gray-100 rounded-md px-2 py-1 text-sm" 
              [(ngModel)]="selectedPrototype" 
              (change)="changePrototype(selectedPrototype.path)">
        <option *ngFor="let prototype of availablePrototypes" 
                [ngValue]="prototype">{{ prototype.name }}</option>
      </select>
    </div>

    <!-- Contenedor de imagen con heatmap -->
    <div class="prototype-image-container relative border border-gray-300 rounded-lg overflow-hidden">
      <!-- Imagen del prototipo -->
      <img #prototypeImage class="w-full prototype-image" [src]="selectedPrototype.path" alt="Prototipo" />
      
      <!-- Capa de heatmap que irá sobre la imagen -->
      <div class="heatmap-overlay absolute top-0 left-0 w-full h-full"></div>
    </div>
    
    <!-- Controles de heatmap -->
    <div class="heatmap-controls mt-4 flex gap-3">
      <button class="px-3 py-1 rounded-md text-sm"
              [class.bg-blue-600]="!showMisclicksOnly"
              [class.text-white]="!showMisclicksOnly"
              [class.bg-gray-200]="showMisclicksOnly"
              [class.text-gray-700]="showMisclicksOnly"
              (click)="showMisclicksOnly = false; filterClicks()">
        Todos los clicks
      </button>
      <button class="px-3 py-1 rounded-md text-sm"
              [class.bg-blue-600]="showMisclicksOnly"
              [class.text-white]="showMisclicksOnly"
              [class.bg-gray-200]="!showMisclicksOnly"
              [class.text-gray-700]="!showMisclicksOnly"
              (click)="showMisclicksOnly = true; filterClicks()">
        Sólo misclicks
      </button>
      <div class="ml-auto">
        <select class="bg-gray-100 rounded-md px-2 py-1 text-sm"
                [(ngModel)]="selectedParticipant"
                (change)="filterClicks()">
          <option value="all">Todos los participantes</option>
          <option value="user1">Participante 1</option>
          <option value="user2">Participante 2</option>
          <option value="user3">Participante 3</option>
        </select>
      </div>
    </div>
  </div>

  <div class="metrics w-1/3 p-5">
    <div class="text-md font-bold">Screen metrics</div>
    <div class="flex gap-1">
      <div class="box bg-gray-100 rounded-lg p-2 text-center">
        <div class="text-md">1</div>
        <div class="text-xs">Participant</div>
      </div>
      <div class="box bg-gray-100 rounded-lg p-2 text-center">
        <div class="text-md">1.49s</div>
        <div class="text-xs">Avg. duration</div>
      </div>
      <div class="box bg-gray-100 rounded-lg p-2 text-center">
        <div class="text-md">0%</div>
        <div class="text-xs">Misclick rate</div>
      </div>
    </div>

    <div class="text-md font-bold mt-6">Click areas</div>
    <p class="text-sm text-gray-600">View all clicks, misclicks and order by participant.</p>
    <div class="text-center mt-4 text-gray-600 border border-dashed border-gray-300 rounded-lg p-4 h-40 flex flex-col items-center justify-center">
      <mat-icon>home</mat-icon>
      <p class="text-xs">Click and drag on a screen to focus on an area</p>
    </div>
  </div>
</div>
