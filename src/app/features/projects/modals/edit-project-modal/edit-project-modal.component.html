<h2 mat-dialog-title class="text-xl font-bold mb-4">Edit project</h2>

<mat-dialog-content>
  <form [formGroup]="editProjectForm" (ngSubmit)="onSubmit()">
    <mat-form-field class="w-full">
      <mat-label>Project name</mat-label>
      <input matInput formControlName="name" placeholder="Enter project name">
      <mat-error *ngIf="editProjectForm.get('name')?.hasError('required')">
        Project name is required
      </mat-error>
      <mat-error *ngIf="editProjectForm.get('name')?.hasError('minlength')">
        Project name must be at least 3 characters
      </mat-error>
    </mat-form-field>

    <div class="image-upload-section mt-4">
      <div class="flex items-center justify-between mb-2">
        <label class="text-gray-700">Project image</label>
        @if (selectedImage || imagePreviewUrl) {
          <button type="button" mat-icon-button color="warn" (click)="removeImage()">
            <mat-icon>delete</mat-icon>
          </button>
        }
      </div>

      @if (!imagePreviewUrl) {
        <div class="upload-area border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer hover:border-primary-500"
             (click)="fileInput.click()">
          <mat-icon class="text-gray-400 text-3xl mb-2">cloud_upload</mat-icon>
          <p class="text-gray-600">Click to upload an image</p>
          <p class="text-sm text-gray-500">PNG, JPG up to 5MB</p>
        </div>
      } @else {
        <div class="preview-area relative">
          <img [src]="imagePreviewUrl" class="w-full h-48 object-cover rounded-lg">
          <div class="overlay absolute inset-0 bg-black bg-opacity-50 rounded-lg opacity-0 hover:opacity-100 flex items-center justify-center transition-opacity">
            <button type="button" mat-icon-button color="primary" (click)="fileInput.click()">
              <mat-icon>edit</mat-icon>
            </button>
          </div>
        </div>
      }

      <input #fileInput type="file" hidden accept="image/*" (change)="onFileSelected($event)">
    </div>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button mat-flat-button color="primary" (click)="onSubmit()" [disabled]="!editProjectForm.valid">Save changes</button>
</mat-dialog-actions>
